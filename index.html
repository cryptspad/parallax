<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.9.1/lottie.min.js" integrity="sha512-CWKGqmXoxo+9RjazbVIaiFcD+bYEIcUbBHwEzPlT0FilQq3TCUac+/uxZ5KDmvYiXJvp32O8rcgchkYw6J6zOA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<style>
  body,
html {
  background-color: #ddd;
  margin: 0px;
  height: 100%;
  overflow: hidden;
}

#bodymovin {
  background-color: #000;
  width: 100%;
  height: 100%;
  display: block;
  transform: translate3d(0, 0, 0);
  margin: auto;
}
</style>
<body>
  <div id="bodymovin"></div>
</body>
<script>
    var animData = null;
    console.log(animData)
    var anim;
    var elem = document.getElementById('bodymovin')
    var animationParams = {
        container: elem,
        renderer: 'html',
        loop: true,
        autoplay: true,
        rendererSettings: {
            progressiveLoad:false
        },
        animationData: animData
    };
    anim = bodymovin.loadAnimation(animationParams);
    var lockeds = {
        2: false,
        3: false,
        4: false,
        5: false
    }
    var currentLayerNum = -1;
    var currentPos = [960, 540, -2666.667];
    var mousePos = [960, 540, -2666.667];

    function moveCamera(){
        currentPos[0] = currentPos[0] + (mousePos[0] - currentPos[0])*0.2;
        currentPos[1] = currentPos[1] + (mousePos[1] - currentPos[1])*0.25;
        currentPos[2] = currentPos[2] + (mousePos[2] - currentPos[2])*0.25;		//0.01 es la sensibilidad
        //alert(anim.animationData.layers[0].ks.p.k[0]);
      /*anim.animationData.layers[0].ks.p.k[0] = anim.animationData.layers[0].ks.p.k[0] + 1;
      anim.animationData.layers[0].ks.p.k[1] = anim.animationData.layers[0].ks.p.k[1] + 1;
      anim.animationData.layers[0].ks.p.k[2] = anim.animationData.layers[0].ks.p.k[2] + 1;*/
        anim.animationData.layers[0].ks.p.k[0].s[0] = currentPos[0];
        anim.animationData.layers[0].ks.p.k[0].e[0] = currentPos[0];
        anim.animationData.layers[0].ks.p.k[0].s[1] = currentPos[1];
        anim.animationData.layers[0].ks.p.k[0].e[1] = currentPos[1];
        anim.animationData.layers[0].ks.p.k[0].s[2] = currentPos[2];
        anim.animationData.layers[0].ks.p.k[0].e[2] = currentPos[2];
      //console.log(anim.animationData.layers[0]);
        requestAnimationFrame(moveCamera);
    }

    anim.addEventListener('DOMLoaded', function(){

        moveCamera();

        window.addEventListener('mousemove', function(ev){

            mouseCoords.x = ev.clientX || ev.pageX;
            mouseCoords.y = ev.clientY || ev.pageY;
            theta = Math.atan2(
                windowH/2 - mouseCoords.y,
                windowW/2 - mouseCoords.x
            );

            dist = 2 * Math.sqrt(Math.pow(mouseCoords.x - windowW/2, 2) + Math.pow(mouseCoords.y - windowH/2, 2));
            mousePos[0] = 960 + Math.cos(theta)*dist;
            mousePos[1] = 540 + Math.sin(theta)*dist;
        })
    })

    var windowW, windowH, dist;
    var mouseCoords = {
        x:0,
        y:0
    }
    function calculateSize(){
        windowW = window.innerWidth;
        windowH = window.innerHeight;
    }

    calculateSize();

    function readTextFile(file, callback) {
        var rawFile = new XMLHttpRequest();
        rawFile.overrideMimeType("application/json");
        rawFile.open("GET", file, true);
        rawFile.onreadystatechange = function() {
            if (rawFile.readyState === 4 && rawFile.status == "200") {
                callback(rawFile.responseText);
            }
        }
        rawFile.send(null);
    }

</script>
</html>
